{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/api-communicator.service.ts","webpack:///src/app/app-config.service.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/components/date-picker-past/date-picker-past.component.ts","webpack:///src/app/components/date-picker-past/date-picker-past.component.html","webpack:///src/app/components/loading/loading.component.ts","webpack:///src/app/components/loading/loading.component.html","webpack:///src/app/map-data.service.ts","webpack:///src/app/maps/google-map-ext/google-map-ext.component.ts","webpack:///src/app/maps/google-map-ext/google-map-ext.component.html","webpack:///src/app/maps/maps.module.ts","webpack:///src/app/maps/open-street-map/open-street-map.component.ts","webpack:///src/app/maps/open-street-map/open-street-map.component.html","webpack:///src/app/time-ago-extends.pipe.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","ApiCommunicatorService","http","appConfigService","apiUrl","requestOptions","observe","responseType","apiBaseUrl","key","get","encodeURIComponent","apiKey","object","date","Date","currentTimeZoneDateStr","timeOffsetInMS","getTimezoneOffset","setTime","getTime","toISOString","substring","fromDate","toDate","setDate","getDate","paramsObj","begTimestamp","endTimestamp","objectId","requestParams","Object","map","akey","join","url","providedIn","AppConfigService","href","base","document","querySelector","toPromise","data","appConfig","AppComponent","apiService","mapDataService","title","vehicleList","Map","activeVehicle","activeFetch","activeFetchLoop","objectDateFilter","stopTimeThreshold","stopAllowedDistance","objectDisplayInfo","activeObjectStops","traveledDistance","calcDistance","distanceCalculated$","subscribe","dist","getLastData","res","response","item","set","positionVehicles","error","console","clearInterval","clearVehicles","clearVehicleInfo","timestampDate","timestamp","fetchList","fetchListFromApi","context","setInterval","call","v","activateVehicle","k","clearVehicleTracks","activeObjectList","getRawData","stops","length","previousTime","previousDistance","previousStopDistance","num","totalT","undefined","Distance","DeltaDistance","valueOf","push","toFixed","addVehicleTracks","fetchUnits","objectDateChanged","selector","templateUrl","styleUrls","AppModule","provide","multi","deps","useFactory","loadAppConfig","declarations","imports","providers","bootstrap","DatePickerPastComponent","dateChanged","maxDate","selectedDate","emit","value","dateChange","LoadingComponent","MapDataService","vehiclePositionSource","vehiclesClearedSource","activeVehicleSource","vehicleTrackSource","vehicleTrackClearSource","calculatedDistanceSource","vehiclesPositioned$","asObservable","vehiclesCleared$","vehiclesActivated$","vehicleTrack$","vehicleTracksCleared$","vehicles","next","vehicle","positions","GoogleMapExtComponent","mapData","differs","markers","stopMarkers","markerCluster","polylines","distService","matInstance","google","maps","DistanceMatrixService","routeInstance","DirectionsService","distServiceCount","zoom","subscription","addVehicles","addVehicleTrack","clearVehicleTrack","markerChanges","center","lat","lng","markerDiffer","find","create","vehs","addMarker","objectName","latitude","longitude","clearMarkers","tracks","addPolyline","veh","_googleMap","imagePath","imageExtension","markerElements","changes","changeDiff","diff","forEachAddedItem","change","marker","_marker","getTitle","forEachRemovedItem","removeMarker","s","unsubscribe","label","position","exist","color","text","fontWeight","options","animation","Animation","DROP","coords","pos","Latitude","Longitude","waypoints","LatLng","bounds","LatLngBounds","icon","path","SymbolPath","CIRCLE","scale","extend","fitBounds","lw","lc","requestOptimalRouteByRoute","sendCalculatedDistance","wayPointChuncks","distlen","c","chunk","origin","destination","travelMode","TravelMode","DRIVING","i","location","stopover","end","pop","reqD","route","statuses","DirectionsStatus","distance","routes","legs","leg","processWayPointChunks","dest","slice","j","origins","destinations","getDistanceMatrix","DistanceMatrixStatus","rows","r","elems","elements","elem","status","requestFunctionData","currentDistServiceCount","localService","localMapData","totalDistance","getDistances","count","OK","setTimeout","shift","km","OVER_QUERY_LIMIT","MapsModule","OpenStreetMapComponent","lon","target","layers","source","view","controls","features","addLayer","TimeAgoExtendsPipe","name","pure","environment","production","bootstrapModule","err"],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport {TimePosition, Vehicle} from './app.component';\nimport {AppConfigService} from './app-config.service';\n\n/*\n Service that communicates with Fleet Complete API\n */\n\ninterface LastData<T> {\n  status: number;\n  response: Array<T>;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ApiCommunicatorService {\n\n  apiUrl = '';\n  requestOptions = {observe: 'body', responseType: 'json'};\n\n  constructor(private http: HttpClient, appConfigService: AppConfigService) {\n    this.apiUrl = appConfigService.apiBaseUrl;\n  }\n\n  getLastData(key: string) {\n    return this.http.get<LastData<Vehicle>>(this.apiUrl + 'getLastData?json&key=' + encodeURIComponent(key));\n  }\n\n  getRawData(apiKey: string, object: string, date: Date){\n    date = new Date(date);\n    let currentTimeZoneDateStr = (date: Date) => {\n      var timeOffsetInMS:number = date.getTimezoneOffset() * 60000;\n      date.setTime(date.getTime() - timeOffsetInMS);\n      return date.toISOString().substring(0, 10);\n    };\n    const fromDate: string = currentTimeZoneDateStr(date);\n    const toDate: string = currentTimeZoneDateStr(new Date(date.setDate(date.getDate() + 1)));\n    const paramsObj = {\n      key: apiKey,\n      begTimestamp : fromDate,\n      endTimestamp : toDate,\n      objectId : object\n    };\n    // Not very efficient way of putting together string, but the object is small enough.\n    const requestParams = Object.keys(paramsObj).map((akey) => {\n      return encodeURIComponent(akey) + '=' + encodeURIComponent(paramsObj[akey]);\n    }).join('&');\n    const url = this.apiUrl + 'getRawData?json&' + requestParams;\n    return this.http.get<LastData<TimePosition>>(url);\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AppConfigService {\n\n  private appConfig: any;\n\n  constructor(private http: HttpClient) { }\n\n  loadAppConfig() {\n    let href = '';\n    let base = document.querySelector(\"base\");\n    if(base !== null) href = base.href\n    return this.http.get(href + 'assets/config.json')\n      .toPromise()\n      .then(data => {\n        this.appConfig = data;\n      });\n  }\n\n  // This is an example property ... you can make it however you want.\n  get apiBaseUrl() {\n\n    if (!this.appConfig) {\n      throw Error('Config file not loaded!');\n    }\n\n    return this.appConfig.apiBaseUrl;\n  }\n}\n","import { Component } from '@angular/core';\nimport {ApiCommunicatorService} from './api-communicator.service';\nimport {MapDataService} from './map-data.service';\n\n\nexport interface Vehicle {\n  objectId: string;\n  objectName: string;\n  plate: string;\n  speed: string;\n  timestamp: string;\n  longitude: number;\n  latitude: number;\n  timestampDate?: Date;\n}\n\nexport interface TimePosition {\n  timestamp: string;\n  Longitude: number;\n  Latitude: number;\n  EngineStatus: string;\n  timestampDate?: Date;\n  Distance?: number;\n  DeltaDistance?: number;\n  speed: number;\n}\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css'],\n})\nexport class AppComponent {\n  title = 'FleetComplete';\n  apiKey = '';\n  vehicleList: Map<string ,Vehicle> = new Map<string, Vehicle>();\n  activeVehicle: Vehicle = null;\n  activeFetch = false;\n  activeFetchLoop = null;\n  objectDateFilter = new Date();\n  stopTimeThreshold = 120000;\n  stopAllowedDistance = 0.008;\n  activeObjectList: TimePosition[];\n  objectDisplayInfo = {\n    activeObjectStops: [],\n    traveledDistance: null,\n    calcDistance: \"\",\n  };\n\n  constructor(private apiService: ApiCommunicatorService, private mapDataService: MapDataService) {\n    mapDataService.distanceCalculated$.subscribe( (dist) => {\n      this.objectDisplayInfo.calcDistance = dist;\n    })\n  }\n\n  fetchListFromApi(){\n    this.apiService.getLastData(this.apiKey).subscribe((res) => {\n        if (this.activeFetch === true) return;\n        const response: Array<Vehicle> = res.response;\n        for (const item of response){\n          if(this.vehicleList.get(item.objectId)) {\n            this.vehicleList.set(item.objectId,item);\n          }\n        }\n        this.mapDataService.positionVehicles(this.vehicleList);\n      },\n      (error) => {\n        console.error(error);\n      }\n    );\n  }\n\n  fetchUnits(akey: string) {\n    if (this.activeFetch === true) { return;}\n    if (this.activeFetchLoop !== null) clearInterval(this.activeFetchLoop);\n    this.apiKey = akey;\n    this.mapDataService.clearVehicles();\n    this.clearVehicleInfo();\n    this.activeVehicle = null;\n    this.vehicleList = new Map<string, Vehicle>();\n    if (this.apiKey !== '') {\n      this.activeFetch = true;\n      this.apiService.getLastData(this.apiKey).subscribe((res) => {\n          this.activeFetch = false;\n          const response: Array<Vehicle> = res.response;\n          for (const item of response){\n            item.timestampDate = new Date(item.timestamp);\n            this.vehicleList.set(item.objectId,item);\n          }\n          this.mapDataService.positionVehicles(this.vehicleList);\n          let fetchList = this.fetchListFromApi;\n          let context = this;\n          this.activeFetchLoop = setInterval(function() {\n            fetchList.call(context);\n          },30000);\n        },\n        (error) => {\n          this.activeFetch = false;\n          this.apiKey == '';\n          console.error(error);\n        }\n      );\n    }\n  }\n\n  chooseVehicle(v) {\n    if (this.activeVehicle !== null && this.activeVehicle.objectId !== v.objectId){\n      this.clearVehicleInfo();\n    }\n    this.activeVehicle = v;\n    this.mapDataService.activateVehicle(v);\n  }\n\n  objectDateChanged(date: Date){\n    this.objectDateFilter = date;\n  }\n\n  private clearVehicleInfo(){\n    // tslint:disable-next-line:forin\n    for (const k in this.objectDisplayInfo){\n      this.objectDisplayInfo[k] = '';\n    }\n    this.mapDataService.clearVehicleTracks();\n  }\n\n  calcDistance() {\n    this.clearVehicleInfo();\n    if (this.activeVehicle) {\n      this.activeFetch = true;\n      this.activeObjectList = [];\n      this.apiService.getRawData(this.apiKey, this.activeVehicle.objectId, this.objectDateFilter).subscribe((res) => {\n        this.activeFetch = false;\n        this.objectDisplayInfo.calcDistance = null;\n        this.activeObjectList = [];\n        const stops: number[] = [];\n        const response: Array<TimePosition> = res.response;\n        if (response.length > 0){\n          let previousTime = new Date(response[0].timestamp);\n          let previousDistance = -1;\n          let previousStopDistance = -1;\n          let num = 0;\n          let totalT = 0;\n          for (const item of response){\n            if(item.timestamp === undefined) continue;\n            item.timestampDate = new Date(item.timestamp);\n\n            if (item.Distance === undefined) {\n              if(item.DeltaDistance === undefined || item.DeltaDistance === null) {\n                continue;\n              }\n              totalT += item.DeltaDistance;\n              item.Distance = totalT;\n            } else {\n              if (previousDistance === item.Distance) {\n                continue;\n              }\n            }\n\n            // if time difference between movements is over x minutes\n            if (item.timestampDate.valueOf() - previousTime.valueOf() > this.stopTimeThreshold && item.Distance - previousStopDistance > this.stopAllowedDistance) {\n              stops.push(num);\n              previousStopDistance = item.Distance;\n            }\n            num++;\n            this.activeObjectList.push(item);\n            previousDistance = item.Distance;\n            previousTime = item.timestampDate;\n          }\n          if(this.activeObjectList.length > 0) {\n            this.objectDisplayInfo.activeObjectStops = stops;\n            this.objectDisplayInfo.traveledDistance =\n              (this.activeObjectList[this.activeObjectList.length - 1].Distance - this.activeObjectList[0].Distance).toFixed(2);\n          } else {\n            if(totalT > 0)this.objectDisplayInfo.traveledDistance = totalT.toFixed(2);\n          }\n        }\n        this.mapDataService.addVehicleTracks(this.activeObjectList, stops);\n      },\n      error => {\n        this.activeFetch = false;\n        console.error(error);\n      }\n    );\n    }\n  }\n\n\n}\n","<style>\n  :host {\n    font-family: -apple-system, Gotham, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\";\n    font-size: 14px;\n    color: #333;\n    box-sizing: border-box;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6 {\n    margin: 8px 0;\n  }\n\n  p {\n    margin: 0;\n  }\n\n  .tx-left{\n    text-align: left;\n  }\n  .tx-right{\n    text-align: right;\n  }\n\n  .spacer {\n    flex: 1;\n  }\n\n  .msg-not{\n    color: #686868;\n    font-size: 12px;\n    font-style: italic;\n    text-align: center;\n  }\n\n  .fc-container{\n    max-width: 1480px;\n    margin-left: auto;\n    margin-right: auto;\n  }\n\n  .toolbar {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 60px;\n    background-color: #FFFFFF;\n    color: #080808;\n    font-weight: 600;\n  }\n\n  .toolbar .fc-container{\n    display: flex;\n    align-items: center;\n    height: 100%;\n  }\n\n  .toolbar .api-key-cont *{\n    margin-right: 6px;\n  }\n\n  .content {\n    display: flex;\n    margin: 82px auto 32px;\n    padding: 0 16px;\n    flex-direction: column;\n    align-items: center;\n    //background-color: #095991;\n    //color: #FFFFFF;\n  }\n\n  div.rocket-back{\n    position: fixed;\n    top: 0;\n    left: 10%;\n    height: 96vh;\n    overflow: hidden;\n    z-index: -8;\n  }\n\n  svg#rocket-smoke {\n    height: 120vh;\n    position: relative;\n    top: 0;\n    left: 10%;\n    z-index: -10;\n    transform: rotate(10deg);\n  }\n  svg#rocket-smoke2 {\n    height: 120vh;\n    position: absolute;\n    top: 0;\n    left: 12%;\n    z-index: -20;\n    transform: rotate(10deg);\n  }\n\n  a,\n  a:visited,\n  a:hover {\n    color: #1976d2;\n    text-decoration: none;\n  }\n\n  a:hover {\n    color: #125699;\n  }\n\n  button.fc-button {\n    background: #3672A5;\n    border: 1px solid #0C5690;\n    color: #ffffff;\n    font-weight: 500;\n    padding: 6px 6px;\n    min-width: 62px;\n    border-radius: 3px;\n    outline:none;\n  }\n  button.fc-button:hover{\n    cursor: pointer;\n  }\n  button.fc-button:focus {\n    border: 1px dashed #0ca9fa;\n    outline:none;\n    text-decoration: none;\n  }\n\n  button.fc-button:disabled{\n    opacity: 0.7;\n  }\n  button.fc-button:disabled:hover{\n    cursor: not-allowed;\n  }\n\n  .main-panel{\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap;\n    justify-content: space-between;\n    width: 100%;\n  }\n\n  .main-panel>.list-view{\n    max-width: 400px;\n    min-width: 240px;\n    width: 20vw;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: wrap;\n  }\n  .main-panel>.list-view>*{\n    background-color: rgba(128,128,128,0.1);\n  }\n\n  .main-panel .vhl-list{\n    height: 240px;\n    height: 40vh;\n    min-height: 200px;\n    position: relative;\n    overflow-y: auto;\n    margin-bottom: 12px;\n  }\n  .main-panel .list-view table{\n    width: 100%;\n  }\n  .main-panel .list-view table th,\n  .main-panel .list-view table td{\n    padding: 6px 4px;\n  }\n  .main-panel .list-view{\n    position: relative;\n  }\n  .main-panel .list-view table thead tr:first-child{\n    position: sticky;\n    top: 0;\n    background-color: #f2f2f2;\n  }\n\n\n\n  .main-panel .vhl-list table tbody tr:hover{\n    cursor: pointer;\n  }\n  .main-panel .list-view table tbody tr:nth-child(odd){\n    background-color: rgba(0,0,0,0.2);\n  }\n  .main-panel .vhl-list table tbody tr.active{\n    font-weight: 500;\n  }\n\n  .main-panel .trip-calc table {\n    margin-top: 12px;\n  }\n  .main-panel .trip-calc table tr td{\n    padding: 8px 6px;\n  }\n  .main-panel .trip-calc table tr td:nth-child(2){\n    min-width: 42px;\n  }\n\n  .main-panel .trip-calc{\n    height: 240px;\n    height: 20vh;\n    min-height: 180px;\n    position: relative;\n    overflow: hidden;\n  }\n\n  #map{\n    width: 100%;\n    max-width: 1080px;\n  }\n\n  .main-panel .date-filter-row *{\n    margin-right: 6px;\n  }\n  .main-panel .date-filter-row input{\n    max-width: 120px;\n  }\n\n  @media screen and (max-width: 1420px) {\n    #map{\n      width: 100%;\n      max-width: 68vw;\n    }\n  }\n\n  @media screen and (max-width: 900px) {\n    #map{\n      width: 100%;\n      max-width: 98vw;\n    }\n    .main-panel{\n      align-items: center;\n      justify-content: center;\n    }\n    .main-panel>.list-view{\n      width: 98vw;\n    }\n  }\n\n\n  @media screen and (max-width: 767px) {\n\n    svg#rocket-smoke2 {\n      right: 130px;\n    }\n    svg#rocket-smoke {\n      right: 120px;\n      transform: rotate(-5deg);\n    }\n  }\n\n  @media screen and (max-width: 575px) {\n    svg#rocket-smoke2,\n    svg#rocket-smoke {\n      display: none;\n      visibility: hidden;\n    }\n  }\n</style>\n\n<!-- Toolbar -->\n<div class=\"toolbar\" role=\"banner\">\n  <div class=\"fc-container\">\n    <div class=\"api-key-cont\">\n      <label for=\"fc-api-key\" i18n=\"api key input| \">Enter API key</label>\n      <input id=\"fc-api-key\" type=\"text\" #typedKey>\n      <button class=\"fc-button\" i18n=\"api key go| Make API key request\" (click)=\"fetchUnits(typedKey.value)\">Go</button>\n    </div>\n    <div class=\"spacer\"></div>\n    <span i18n=\"header message| Toolbar welcome message\">Fleet Complete API tester</span>\n  </div>\n</div>\n\n<div class=\"rocket-back\">\n<svg id=\"rocket-smoke\" alt=\"Rocket Ship Smoke\" xmlns=\"http://www.w3.org/2000/svg\" width=\"516.119\" height=\"1083.632\" viewBox=\"0 100 426.119 943.632\">\n  <path id=\"Path_40\" data-name=\"Path 40\" d=\"M644.6,141S143.02,215.537,147.049,870.207s342.774,201.755,342.774,201.755S404.659,847.213,388.815,762.2c-27.116-145.51-11.551-384.124,271.9-609.1C671.15,139.365,644.6,141,644.6,141Z\" transform=\"translate(-147.025 -140.939)\" fill=\"#f5f5f5\"/>\n</svg>\n<svg id=\"rocket-smoke2\" alt=\"Rocket Ship Smoke\" xmlns=\"http://www.w3.org/2000/svg\" width=\"516.119\" height=\"1083.632\" viewBox=\"0 100 426.119 943.632\">\n  <path id=\"Path_40\" data-name=\"Path 40\" d=\"M644.6,141S143.02,215.537,147.049,870.207s342.774,201.755,342.774,201.755S404.659,847.213,388.815,762.2c-27.116-145.51-11.551-384.124,271.9-609.1C671.15,139.365,644.6,141,644.6,141Z\" transform=\"translate(-147.025 -140.939)\" fill=\"#f0f3f6\"/>\n</svg>\n</div>\n<div class=\"content fc-container\" role=\"main\">\n\n  <div class=\"main-panel\">\n    <div class=\"list-view\">\n      <div class=\"vhl-list\">\n        <table>\n          <thead>\n          <tr><th class=\"tx-left\" i18n>Name</th><th class=\"tx-right\" i18n>Speed</th><th class=\"tx-right\" i18n>Last Update</th></tr>\n          </thead>\n          <tbody>\n          <tr *ngFor=\"let vel of vehicleList | keyvalue\" [ngClass]=\"{'active': activeVehicle == vel.value}\" (click)=\"chooseVehicle(vel.value)\">\n            <td class=\"tx-left\">{{vel.value.objectName}}</td><td class=\"tx-right\">{{vel.value.speed}}</td><td class=\"tx-right\">{{vel.value.timestamp | timeAgo}}</td>\n          </tr>\n          </tbody>\n        </table>\n        <div class=\"msg-not\" *ngIf=\"vehicleList.size === 0 && activeFetch=== false\" style=\"margin-top: 10vh\">\n          <span i18n>(No vehicles found)</span>\n        </div>\n        <app-loading *ngIf=\"activeFetch=== true\" style=\"margin-top: 10vh\"></app-loading>\n      </div>\n      <div class=\"trip-calc\">\n        <div class=\"date-filter-row\">\n          <label i18n>Date</label>\n          <app-date-picker-past (dateChanged)=\"objectDateChanged($event)\"></app-date-picker-past>\n          <button class=\"fc-button\" i18n=\"vehicle key go| Request detailed Vehicle info\" (click)=\"calcDistance()\" [disabled]=\"activeVehicle === null\">Go</button>\n        </div>\n        <div class=\"trip-info\">\n          <table>\n            <tbody>\n            <tr><td class=\"tx-left\" i18n>Total Distance</td><td class=\"tx-right\">\n              {{objectDisplayInfo.traveledDistance}} <span *ngIf=\"objectDisplayInfo.traveledDistance !== null&& objectDisplayInfo.traveledDistance !== ''\" i18n=\"kilometer\">km</span>\n            </td></tr>\n            <tr><td class=\"tx-left\" i18n>Number of Stops</td><td class=\"tx-right\">{{objectDisplayInfo.activeObjectStops.length}}</td></tr>\n            <tr><td class=\"tx-left\" i18n>Calculated Distance</td><td class=\"tx-right\">{{objectDisplayInfo.calcDistance}}\n              <div [ngSwitch]=\"objectDisplayInfo.calcDistance\" style=\"display: inline-block\">\n                <app-loading *ngSwitchCase=\"null\"></app-loading>\n                <span *ngSwitchCase=\"'-'\"></span>\n                <span *ngSwitchCase=\"''\"></span>\n                <span *ngSwitchDefault>km</span>\n              </div>\n            </td></tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n    <div id=\"map\" class=\"map-view\">\n<!--          <app-open-street-map></app-open-street-map>-->\n      <app-google-map-ext></app-google-map-ext>\n    </div>\n  </div>\n\n</div>\n","import { BrowserModule } from '@angular/platform-browser';\nimport {APP_INITIALIZER, NgModule, Pipe} from '@angular/core';\nimport { HttpClientModule } from '@angular/common/http';\nimport { AppComponent } from './app.component';\nimport {MatDatepickerModule} from '@angular/material/datepicker';\nimport {MatNativeDateModule} from '@angular/material/core';\nimport {BrowserAnimationsModule} from '@angular/platform-browser/animations';\nimport { DatePickerPastComponent } from './components/date-picker-past/date-picker-past.component';\nimport {MapsModule} from './maps/maps.module';\nimport {ReactiveFormsModule} from '@angular/forms';\nimport { TimeAgoExtendsPipe } from './time-ago-extends.pipe';\nimport { LoadingComponent } from './components/loading/loading.component';\nimport {AppConfigService} from './app-config.service';\n\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    DatePickerPastComponent,\n    TimeAgoExtendsPipe,\n    LoadingComponent,\n  ],\n  imports: [\n    BrowserModule,\n    HttpClientModule,\n    MatDatepickerModule,\n    MatNativeDateModule,\n    BrowserAnimationsModule,\n    MapsModule,\n    ReactiveFormsModule,\n  ],\n  providers: [\n    {\n      provide: APP_INITIALIZER,\n      multi: true,\n      deps: [AppConfigService],\n      useFactory: (appConfigService: AppConfigService) => {\n        return () => {\n          //Make sure to return a promise!\n          return appConfigService.loadAppConfig();\n        };\n      }\n    }\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import {Component, EventEmitter, OnInit, Output} from '@angular/core';\nimport {FormControl} from '@angular/forms';\n\n@Component({\n  selector: 'app-date-picker-past',\n  templateUrl: './date-picker-past.component.html',\n  styleUrls: ['./date-picker-past.component.css']\n})\nexport class DatePickerPastComponent implements OnInit {\n  maxDate: Date;\n  selectedDate: FormControl;\n  @Output() dateChanged = new EventEmitter<Date>();\n\n  constructor() {\n    this.maxDate = new Date();\n    this.selectedDate = new FormControl(this.maxDate);\n    this.dateChanged.emit(this.selectedDate.value);\n  }\n\n  dateChange(){\n    this.dateChanged.emit(this.selectedDate.value);\n  }\n\n  ngOnInit(): void {\n  }\n\n}\n","<input [matDatepicker]=\"vehicleDatepicker\" [max]=\"maxDate\" [formControl]=\"selectedDate\" (dateChange)=\"dateChange()\">\n<mat-datepicker-toggle [for]=\"vehicleDatepicker\"></mat-datepicker-toggle>\n<mat-datepicker #vehicleDatepicker></mat-datepicker>\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-loading',\n  templateUrl: './loading.component.html',\n  styleUrls: ['./loading.component.css']\n})\nexport class LoadingComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<style>\n  :host {\n    transition: opacity .4s;\n  }\n  :host.hide-in-proc {\n    transition: opacity .4s;\n    opacity: 0;\n  }\n  span.loading {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: 16px;\n    color: #868686;\n    font-size: 2.5em;\n    text-shadow: 2px 2px 10px rgba(0,0,0,0.2);\n  }\n  body {\n    margin: 0;\n    padding: 0;\n  }\n\n  @keyframes dots {\n    50% {\n      transform: translateY(-.4rem);\n    }\n    100% {\n      transform: translateY(0);\n    }\n  }\n\n  .d {\n    animation: dots 1.5s ease-out infinite;\n  }\n  .d-2 {\n    animation-delay: .5s;\n  }\n  .d-3 {\n    animation-delay: 1s;\n  }\n</style>\n<span class=\"loading\">\n<span class=\"d\">.</span><span class=\"d d-2\">.</span><span class=\"d d-3\">.</span>\n</span>\n","import { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\nimport {TimePosition, Vehicle} from './app.component';\nimport {strict} from 'assert';\n\n/*\n Service that communicates with Maps API\n*/\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MapDataService {\n\n  // Observable string sources\n  private vehiclePositionSource = new Subject<Map<string, Vehicle>>();\n  private vehiclesClearedSource = new Subject();\n  private activeVehicleSource = new Subject<Vehicle>();\n  private vehicleTrackSource = new Subject<[TimePosition[], number[]]>();\n  private vehicleTrackClearSource = new Subject();\n\n  private calculatedDistanceSource = new Subject<string>();\n\n  // Observable string streams\n  vehiclesPositioned$ = this.vehiclePositionSource.asObservable();\n  vehiclesCleared$ = this.vehiclesClearedSource.asObservable();\n  vehiclesActivated$ = this.activeVehicleSource.asObservable();\n  vehicleTrack$ = this.vehicleTrackSource.asObservable();\n  vehicleTracksCleared$ = this.vehicleTrackClearSource.asObservable();\n\n  distanceCalculated$ = this.calculatedDistanceSource.asObservable();\n\n  // Service message commands\n  positionVehicles(vehicles: Map<string, Vehicle>) {\n    this.vehiclePositionSource.next(vehicles);\n  }\n\n  clearVehicles() {\n    this.vehiclesClearedSource.next();\n  }\n\n  activateVehicle(vehicle: Vehicle) {\n    this.activeVehicleSource.next(vehicle);\n  }\n\n  addVehicleTracks(positions: TimePosition[], stops: number[]) {\n    this.vehicleTrackSource.next([positions, stops]);\n  }\n\n  clearVehicleTracks() {\n    this.vehicleTrackClearSource.next();\n  }\n\n  sendCalculatedDistance(dist: string) {\n    this.calculatedDistanceSource.next(dist);\n  }\n}\n","import {AfterViewInit, Component, IterableDiffers, OnDestroy, OnInit, QueryList, ViewChild, ViewChildren} from '@angular/core';\nimport {Subscription} from 'rxjs';\nimport {MapDataService} from '../../map-data.service';\nimport {MapMarker, MapPolyline} from '@angular/google-maps';\nimport {TimePosition} from '../../app.component';\nimport MarkerClusterer from '@google/markerclustererplus';\n\n\ninterface CurrentMapMarker {\n  position: { lat: number, lng: number};\n  label?: {\n    color?: string,\n    text?: string,\n    fontWeight?: string\n  };\n  title: string;\n  options?: any;\n}\n\ninterface CurrentMapPolyline {\n  path: object[];\n}\n\ninterface MapServiceSubscriptions {\n  addVehicles: Subscription;\n  clearVehicles: Subscription;\n  activateVehicle: Subscription;\n  addVehicleTrack: Subscription;\n  clearVehicleTrack: Subscription;\n  markerChanges: Subscription;\n}\n@Component({\n  selector: 'app-google-map-ext',\n  templateUrl: './google-map-ext.component.html',\n  styleUrls: ['./google-map-ext.component.css']\n})\nexport class GoogleMapExtComponent implements OnInit, OnDestroy, AfterViewInit {\n\n  markers: Map<string, CurrentMapMarker> = new Map<string, CurrentMapMarker>();\n  stopMarkers: CurrentMapMarker[] = [];\n  @ViewChildren(MapMarker) markerElements: QueryList<MapMarker>;\n  markerCluster = null;\n  polylines: CurrentMapPolyline[] = [];\n  markerDiffer;\n  distService = {\n    matInstance: new google.maps.DistanceMatrixService(),\n    routeInstance: new google.maps.DirectionsService(),\n    distServiceCount: 0\n  };\n\n\n  @ViewChild('map') map;\n  zoom = 12;\n  center: google.maps.LatLngLiteral;\n  subscription: MapServiceSubscriptions = {\n    addVehicles: null,\n    clearVehicles: null,\n    activateVehicle: null,\n    addVehicleTrack: null,\n    clearVehicleTrack: null,\n    markerChanges: null,\n  };\n\n  constructor(private mapData: MapDataService, private differs: IterableDiffers) {\n    this.center = {\n      lat: 58.370568,\n      lng: 26.715893,\n    };\n    this.markerDiffer = this.differs.find([]).create(null);\n    this.subscription.addVehicles = mapData.vehiclesPositioned$.subscribe(\n      vehs => {\n        for (const v of vehs){\n          this.addMarker(v[1].objectName, [v[1].latitude, v[1].longitude]);\n        }\n      });\n\n    this.subscription.clearVehicles = mapData.vehiclesCleared$.subscribe(\n      () => {\n        if (this.markerCluster !== null) { this.markerCluster.clearMarkers(); }\n        this.markers = new Map<string, CurrentMapMarker>();\n        this.stopMarkers = [];\n      });\n\n    this.subscription.addVehicles = mapData.vehicleTrack$.subscribe(\n      tracks => {\n        this.addPolyline(tracks[0], tracks[1]);\n      });\n    this.subscription.clearVehicleTrack = mapData.vehicleTracksCleared$.subscribe(\n      () => {\n        this.polylines = [];\n        this.stopMarkers = [];\n      });\n\n    this.subscription.activateVehicle = mapData.vehiclesActivated$.subscribe(\n      (veh) => {\n        this.center = {\n          lat: veh.latitude,\n          lng: veh.longitude,\n        };\n      });\n  }\n\n  ngOnInit(): void {}\n\n  ngAfterViewInit(): void {\n    this.markerCluster = new MarkerClusterer(this.map._googleMap, [], {imagePath: 'assets/img/maps_cluster/m', imageExtension: 'png'});\n    this.subscription.markerChanges = this.markerElements.changes.subscribe(\n      tracks => {\n        const changeDiff = this.markerDiffer.diff(tracks);\n        if (changeDiff) {\n          changeDiff.forEachAddedItem((change) => {\n            const marker = change.item._marker;\n            if (marker.getTitle() === '') {\n              return;\n            }\n            this.markerCluster.addMarker(marker);\n          });\n          changeDiff.forEachRemovedItem((change) => {\n            const marker = change.item._marker;\n            if (marker.getTitle() === '') {\n              return;\n            }\n            this.markerCluster.removeMarker(marker);\n          });\n        }\n      });\n  }\n\n  ngOnDestroy() {\n    // tslint:disable-next-line:forin\n    for (const s in this.subscription){\n      if (this.subscription[s] === null) {\n        continue;\n      }\n      this.subscription[s].unsubscribe();\n    }\n  }\n\n  addMarker(label: string, position: [number, number]) {\n    let exist = this.markers.get(label);\n    if (exist) {\n      exist.position = {\n        lat: position[0],\n        lng: position[1],\n      };\n      return;\n    }\n    this.markers.set(label,{\n      position: {\n        lat: position[0],\n        lng: position[1],\n      },\n      label: {\n        color: '#080808',\n        text: label,\n        fontWeight: '500'\n      },\n      title: label,\n      options: {animation: google.maps.Animation.DROP}\n    });\n  }\n\n\n  addPolyline(tracks: TimePosition[], stops: number[]){\n    const coords = [];\n    for (const pos of tracks){\n      coords.push({\n        lat: pos.Latitude,\n        lng: pos.Longitude,\n      });\n    }\n\n    const waypoints: google.maps.LatLng[] = [];\n    if (stops.length > 0){\n      waypoints.push(new google.maps.LatLng(coords[0]));\n    }\n    const bounds = new google.maps.LatLngBounds();\n    for (const s of stops){\n      this.stopMarkers.push({\n        position: coords[s],\n        title: '',\n        options: {icon: {\n            path: google.maps.SymbolPath.CIRCLE,\n            scale: 4\n          }}\n      });\n      bounds.extend(coords[s]);\n      waypoints.push(new google.maps.LatLng(coords[s]));\n    }\n\n    if (stops.length > 0) {\n      if (stops.length > 1) {\n        this.map._googleMap.fitBounds(bounds);\n      } else {\n        this.center = coords[stops[0]];\n      }\n      const lw = waypoints[waypoints.length - 1];\n      const lc = coords[coords.length - 1];\n      if (lw.lat() !== lc.lat || lw.lng() !== lc.lng){\n        waypoints.push(new google.maps.LatLng(lc));\n      }\n    }\n    this.polylines.push({\n      path: coords\n    });\n    if (coords.length > 0){\n      this.requestOptimalRouteByRoute(waypoints);\n    } else {\n      this.mapData.sendCalculatedDistance(\"-\");\n    }\n  }\n\n  requestOptimalRouteByRoute(waypoints: google.maps.LatLng[]){\n\n\n    let wayPointChuncks: google.maps.DirectionsRequest[] = [];\n    let distlen = 10;\n    let c = 0;\n    let chunk: google.maps.DirectionsRequest = {\n      origin: null,\n      destination: null,\n      travelMode: google.maps.TravelMode.DRIVING,\n      waypoints: []\n    };\n    distlen+=2;\n    for (let i = 0; i < waypoints.length; i++){\n\n      c++;\n      switch (c) {\n        case 1:\n          chunk.origin = waypoints[i];\n          break;\n        case distlen:\n          chunk.destination = waypoints[i];\n          wayPointChuncks.push(chunk);\n          chunk = {\n            origin: null,\n            destination: null,\n            travelMode: google.maps.TravelMode.DRIVING,\n            waypoints: []\n          };\n          c=0;\n          i--;\n          break;\n        default:\n          // @ts-ignore\n          chunk.waypoints.push({ location: waypoints[i], stopover:true});\n      }\n\n    }\n    if (chunk.waypoints.length > 0){\n      let end = chunk.waypoints.pop();\n      chunk.destination = end.location;\n      wayPointChuncks.push(chunk);\n    }\n\n    let reqD = {\n      req: this.distService.routeInstance.route,\n      statuses: google.maps.DirectionsStatus,\n      calcDistance: function(response): number {\n        let distance = 0;\n        for (const leg of response.routes[0].legs){\n          if (leg.distance !== undefined){\n            distance += leg.distance.value;\n          } else {\n            return  null;\n          }\n        }\n        return distance;\n      }\n    };\n    this.processWayPointChunks(wayPointChuncks, reqD);\n  }\n\n\n  // Try the matrix request. sends less data, but slower since needs to request every distance separately.\n  requestOptimalRouteByMatrix(waypoints: google.maps.LatLng[]){\n    const dest = waypoints.slice(1);\n    waypoints.pop();\n\n    let wayPointChuncks: google.maps.DistanceMatrixRequest[] = [];\n    let distlen = 1;\n    let j = 0;\n    let c = 0;\n    let chunk: google.maps.DistanceMatrixRequest = {\n      origins: [],\n      destinations: [],\n      travelMode: google.maps.TravelMode.DRIVING\n    };\n    for (let i = 1; i < waypoints.length; i++,j++){\n      // @ts-ignore\n      chunk.origins.push(waypoints[j]);\n      // @ts-ignore\n      chunk.destinations.push(waypoints[i]);\n      c++;\n      if (c >= distlen){\n        wayPointChuncks.push(chunk);\n        chunk = {\n          origins: [],\n          destinations: [],\n          travelMode: google.maps.TravelMode.DRIVING\n        };\n        c=0;\n      }\n    }\n    if (chunk.origins.length > 0){\n      wayPointChuncks.push(chunk);\n    }\n\n    let reqD = {\n      req: this.distService.matInstance.getDistanceMatrix,\n      statuses: google.maps.DistanceMatrixStatus,\n      calcDistance: function(response): number {\n        let distance = 0;\n        for (const r of response.rows){\n          let elems = r.elements;\n          for (const elem of elems){\n            if (elem.status === 'OK') {\n              distance += elem.distance.value;\n            } else {\n              return null;\n            }\n          }\n        }\n        return distance;\n      }\n    };\n    this.processWayPointChunks(wayPointChuncks, reqD);\n  }\n\n   processWayPointChunks(wayPointChuncks: google.maps.DistanceMatrixRequest[], requestFunctionData){\n    this.distService.distServiceCount++;\n    const currentDistServiceCount = this.distService.distServiceCount;\n    const localService = this.distService;\n    const localMapData = this.mapData;\n    let totalDistance: number = 0;\n    let getDistances = function(dist: google.maps.DistanceMatrixRequest, count: number) {\n      count++;\n      requestFunctionData.req(dist, (response, status) => {\n        if(currentDistServiceCount !== localService.distServiceCount) {\n          localMapData.sendCalculatedDistance(\"\");\n          return;\n        }\n        if (status === requestFunctionData.statuses.OK) {\n          let distance = requestFunctionData.calcDistance(response);\n          if (distance === null){\n            localMapData.sendCalculatedDistance(\"-\");\n            return;\n          } else {\n            totalDistance += distance;\n          }\n          if(wayPointChuncks.length>0){\n            setTimeout(() => {getDistances(wayPointChuncks.shift(),0)},10);\n          } else {\n            const km = totalDistance/1000;\n            localMapData.sendCalculatedDistance(km.toFixed(2));\n          }\n        } else if (status === requestFunctionData.statuses.OVER_QUERY_LIMIT && count < 4) {\n          console.error('Maps error: ', status, count);\n          setTimeout(() => {getDistances(dist,count)},200*count);\n        } else {\n          localMapData.sendCalculatedDistance(\"-\");\n        }\n      });\n    };\n\n    if(wayPointChuncks.length>0){\n      getDistances(wayPointChuncks.shift(),0)\n    } else {\n      localMapData.sendCalculatedDistance(\"-\");\n    }\n  }\n\n}\n","<google-map #map  height=\"80vh\"\n              width=\"100%\"\n              [zoom]=\"zoom\"\n              [center]=\"center\">\n\n  <map-marker\n    *ngFor=\"let marker of markers | keyvalue\"\n    [position]=\"marker.value.position\"\n    [label]=\"marker.value.label\"\n    [title]=\"marker.value.title\"\n    [options]=\"marker.value.options\"\n  >\n  </map-marker>\n  <map-marker\n    *ngFor=\"let marker of stopMarkers\"\n    [position]=\"marker.position\"\n    [label]=\"marker.label\"\n    [title]=\"marker.title\"\n    [options]=\"marker.options\"\n  >\n  </map-marker>\n  <map-polyline *ngFor=\"let poly of polylines\"\n                [path]=\"poly.path\">\n  </map-polyline>\n</google-map>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { OpenStreetMapComponent } from './open-street-map/open-street-map.component';\nimport { GoogleMapsModule } from '@angular/google-maps';\nimport { GoogleMapExtComponent } from './google-map-ext/google-map-ext.component';\n\n\n@NgModule({\n  declarations: [OpenStreetMapComponent, GoogleMapExtComponent],\n  exports: [\n    OpenStreetMapComponent,\n    GoogleMapExtComponent\n  ],\n  imports: [\n    CommonModule,\n    GoogleMapsModule\n  ]\n})\nexport class MapsModule { }\n","import {Component, OnInit} from '@angular/core';\nimport {Map as OsMap, View} from 'ol';\nimport {Tile as TileLayer, Vector as VectorLayer} from 'ol/layer';\nimport VectorSource from 'ol/source/Vector';\nimport {defaults as defaultControls} from 'ol/control';\nimport OSM from 'ol/source/OSM';\nimport 'ol/interaction';\nimport {MapDataService} from '../../map-data.service';\nimport {Subscription} from 'rxjs';\n\ninterface MapServiceSubscriptions {\n  addVehicles: Subscription;\n  clearVehicles: Subscription;\n  activateVehicle: Subscription;\n  addVehicleTrack: Subscription;\n  clearVehicleTrack: Subscription;\n  markerChanges: Subscription;\n}\n\n@Component({\n  selector: 'app-open-street-map',\n  templateUrl: './open-street-map.component.html',\n  styleUrls: ['./open-street-map.component.css'],\n})\nexport class OpenStreetMapComponent implements OnInit {\n\n  map: OsMap;\n  markers;\n\n  center: object;\n  subscription: MapServiceSubscriptions = {\n    addVehicles: null,\n    clearVehicles: null,\n    activateVehicle: null,\n    addVehicleTrack: null,\n    clearVehicleTrack: null,\n    markerChanges: null,\n  };\n\n  constructor(private mapData: MapDataService) {\n    this.center = {\n      lat: 58.370568,\n      lng: 26.715893,\n    };\n\n    this.subscription.addVehicles = mapData.vehiclesPositioned$.subscribe(\n      vehs => {\n        for (const v of vehs){\n          this.addMarker(v[1].objectName, v[1].latitude, v[1].longitude);\n        }\n      });\n\n    this.subscription.clearVehicles = mapData.vehiclesCleared$.subscribe(\n      () => {\n\n      });\n\n    this.subscription.addVehicles = mapData.vehicleTrack$.subscribe(\n      tracks => {\n\n      });\n    this.subscription.clearVehicleTrack = mapData.vehicleTracksCleared$.subscribe(\n      () => {\n\n      });\n\n    this.subscription.activateVehicle = mapData.vehiclesActivated$.subscribe(\n      (veh) => {\n        this.center = {\n          lat: veh.latitude,\n          lng: veh.longitude,\n        };\n      });\n  }\n\n  addMarker(label: string, lon: number, lat: number){\n\n  }\n\n  ngOnInit(): void {\n    this.map = new OsMap({\n      target: 'os-map',\n      layers: [\n        new TileLayer({\n          source: new OSM()\n        })\n      ],\n      view: new View({\n        center: [0, 0],\n        zoom: 0\n      }),\n      controls: defaultControls(),\n    });\n    this.markers = new VectorLayer({\n      source: new VectorSource({\n        features: []\n      }),\n    });\n    this.map.addLayer(this.markers);\n  }\n\n}\n","<style>\n  #os-map{\n    width: 100%;\n    height: 82vh;\n  }\n</style>\n<div id=\"os-map\">\n\n</div>\n<div id=\"os-controls\">\n\n</div>\n","import { Pipe } from '@angular/core';\nimport {TimeAgoPipe} from 'time-ago-pipe';\n\n// Make timeago pipe work in Angular 9\n@Pipe({\n  name: 'timeAgo',\n  pure: false\n})\nexport class TimeAgoExtendsPipe extends TimeAgoPipe {}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"]}